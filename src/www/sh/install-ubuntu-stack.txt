#!/bin/bash
# bash <(curl -s http://test.parentnode.dk/sh/install-ubuntu-stack.txt)

# curl -L http://test.parentnode.dk/sh/install-ubuntu-stack.txt | bash

trap command SIGINT


echo 
echo 
echo "         Welcome to the          "
echo "parentNode/Ubuntu stack installer"
echo "---------------------------------"
echo

if [ ! sudo -n true 2>/dev/null ]; then 
    echo "I got sudo"
else
    echo "I don't have sudo"
fi


# has_sudo=$()
# echo "has sudo: $has_sudo"

if sudo -n true 2>/dev/null; then 

else

	echo "Please enter you password to continue."
	sudo ls &>/dev/null

fi


echo
echo "Updating LOCALE information (Adding en_GB.UTF-8)"
echo
sudo locale-gen en_GB.UTF-8

export LC_ALL="en_GB.utf8"


echo
echo "Updating package information"
echo

# UPDATE APT
sudo apt update


echo
echo "Upgrading package information"
echo
# UPGRADE ALL EXISTING SOFTWARE
sudo apt full-upgrade


echo
echo "Install Git"
echo
# INSTALL GIT
sudo apt install git


# DOES TOOLS ALREADY EXIST - DELETE THEM AND CLONE AGAIN
if [ -d "/srv/tools" ]; then

	sudo rm -R /srv/tools

fi

echo
echo "Clone install tools"
echo
# CLONE THE FULL UBUNTU INSTALL AND TOOLS FROM GITHUB
sudo git clone https://github.com/parentnode/ubuntu_environment /srv/tools


echo
echo "Run installer"
echo
# RUN INSTALL SCRIPT
sudo /srv/tools/_tools/install.sh


