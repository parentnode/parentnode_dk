var AnimatedCore=new function(){this.defaultConfig={maxLoops:3,maxAnimationTime:30,isPoliteBanner:!1,politeLoadDelay:1e3,clickProperty:{clickTag:"clickTag",url:"https://example.com"},renderer:{scale:!1,containerSelector:"#Animated",backgroundColor:14935011,assetsBaseUrl:"images/",transparent:!1,antialias:!1}},this.init=function(){this._b=new AnimatedBanner,this.config=AnimatedUtils.extendObject(this.defaultConfig,this._b.config||{}),this._c=document.querySelector(this.config.renderer.containerSelector),this._cs=this._c.style,this.stage=new PIXI.Container,this.loader=new PIXI.Loader(this.config.renderer.assetsBaseUrl),this.config.renderer.width=this.config.width,this.config.renderer.height=this.config.height,this.renderer=PIXI.autoDetectRenderer(this.config.renderer),this.renderer.plugins.interaction.autoPreventDefault=!1,this.renderer.view.style.width="100%",this.renderer.view.style.display="block",this.renderer.view.style.position="relative",this.renderer.view.style.zIndex="50",this._cs.position="relative",this.config.renderer.scale?this._cs.width="100%":this.config.renderer.resize?(window.addEventListener("resize",this.resized.bind(this)),this.resized()):(this._cs.width=this.config.width+"px",this._cs.height=this.config.height+"px"),!1===this.config.fallback||this.webgl()?(this.loops=1,this._b.stage=this.stage,this._b.renderer=this.renderer,this._b.assets={},this.config.maxAnimationTime&&Tween.delayedCall(this.config.maxAnimationTime,this.stopBanner.bind(this)),Tween.defaultEase=Quad.easeOut,this.setupAssetLoading()):this.fallback()},this.setupAssetLoading=function(){this.config.isPoliteBanner?"Adform"==this.config.bannerType&&"object"==typeof dhtml&&0!==dhtml.getVar("bn",0)?(dhtml.sharedEvents.once("pageLoadComplete",this.loadAssets.bind(this)),dhtml.external.initPoliteMode()):setTimeout(this.loadAssets.bind(this),this.config.politeLoadDelay):this.loadAssets()},this.loadAssets=function(){if(this._preload_graphics=[],this._preload_fonts=[],this._preload_video=[],this._preload_audio=[],this._b.loadQueue&&this._b.loadQueue.length){for(var e,t=0;e=this._b.loadQueue[t];t++)("object"==typeof e&&e.family?this._preload_fonts:this._preload_graphics).push(e);if(this._preload_graphics.length){for(t=0;e=this._preload_graphics[t];t++)"object"==typeof e?this.loader.add(Object.keys(e)[0],e[Object.keys(e)[0]]):this.loader.add(e);this.loader.load(this.graphicAssetsLoaded.bind(this))}this._preload_fonts.length&&("object"==typeof AnimatedFonts?AnimatedFonts.preload(this._preload_fonts,{callback:this.fontAssetsLoaded.bind(this)}):console.log("AnimatedFonts module missing"))}else this.assetsLoadCheck()},this.graphicAssetsLoaded=function(e,t){e&&t&&(t=AnimatedUtils.convertResources(t),this._b.assets=AnimatedUtils.extendObject(this._b.assets,t),this._preload_graphics=[]),this.assetsLoadCheck()},this.fontAssetsLoaded=function(e){e&&(this._preload_fonts=[]),this.assetsLoadCheck()},this.assetsLoadCheck=function(){this._preload_graphics.length||this._preload_fonts.length||(this._c.appendChild(this.renderer.view),this.ready())},this.resized=function(e){"Adform"==this.config.bannerType&&"object"==typeof dhtml&&dhtml.external&&dhtml.external.resize&&dhtml.external.resize("100%","100%"),this._c.parentNode===document.body?(this.banner_w=document.documentElement.clientWidth,this.banner_h=document.documentElement.clientHeight):(this.banner_w=this._c.parentNode.offsetWidth,this.banner_h=this._c.parentNode.offsetHeight),this._cs.width=this.banner_w+"px",this._cs.height=this.banner_h+"px",this.renderer.resize(this.banner_w,this.banner_h),"function"==typeof this._b.resized&&this._b.resized(e)},this.ready=function(){this._b.init(),this.config.renderer.resize&&this.resized(),this.setupClickTag(),this._b.start(),this.render()},this.stopBanner=function(){window.cancelAnimationFrame(this._af),this._b.onBannerStopped()},this.render=function(){this._af=window.requestAnimationFrame(this.render.bind(this)),this._b.onBannerRender(),this.renderer.render(this.stage)},this.remainingLoops=function(){return this.config.maxLoops-this.loops},this.setupClickTag=function(){"function"==typeof this._b.setupClickTag?this._b.setupClickTag():(this._o=this._c.appendChild(document.createElement("div")),_os=this._o.style,_os.position="absolute",_os.zIndex=100,_os.top=0,_os.left=0,_os.width="100%",_os.height="100%",_os.cursor="pointer","object"!=typeof document.ontouchmove&&"function"!=typeof document.ontouchmove||navigator.userAgent.match(/iPhone|iPad/)?this._o.addEventListener("click",function(){this.click(this.config.clickProperty)}.bind(this)):this._o.addEventListener("touchend",function(){this.click(this.config.clickProperty)}.bind(this)))},this.button=function(e,t){e.__clickProperty=AnimatedUtils.extendObject({},this.config.clickProperty,t),e.interactive=!0,e.buttonMode=!0,e.defaultCursor="pointer","object"!=typeof document.ontouchmove&&"function"!=typeof document.ontouchmove||navigator.userAgent.match(/iPhone|iPad/)?e.on("click",function(){AnimatedCore.click(this.__clickProperty)}):e.on("tap",function(){AnimatedCore.click(this.__clickProperty)})},this.click=function(e){switch(this.config.bannerType){case"Adform":this.AdformClick(e);break;case"Google":this.GoogleClick(e);break;case"GoogleStudio":this.GoogleStudioClick(e);break;case"Sizmek":this.SizmekClick(e);break;case"Adtech":this.AdtechClick(e);break;default:this.NeutralClick(e)}},this.NeutralClick=function(e){var t=e.url,e=e.target||"_parent";window.open(t,e)},this.AdformClick=function(e){var t;mraid?mraid.open(Adform.getClickURL(e.clickTag)):(t=dhtml.getVar(e.clickTag,e.url),e=dhtml.getVar("landingPageTarget",e.target||"_parent"),window.open(t,e))},this.AdtechClick=function(){var e=window.bannerClick;window.open(e,"_parent")},this.GoogleClick=function(e){var t=window[e.clickTag],e=e.target||"_parent";window.open(t,e)},this.GoogleStudioClick=function(e){e=window[e.clickTag];Enabler.exit(e)},this.SizmekClick=function(e){console.log("Sizmek click:"),console.log(e);var t=window[e.clickTag];EB.clickthrough(e.clickTag,t)},this.webgl=function(){var e=0,t=["webgl","experimental-webgl","moz-webgl","webkit-3d"];if(window.WebGLRenderingContext)for(var i=document.createElement("canvas");engine=t[e++];)try{return i.getContext(engine),!0}catch(e){}return!1},this.fallback=function(){"function"==typeof this._b.fallback?this._b.fallback():(this.config.fallback?this._cs.background="transparent url("+this.config.fallback+") no-repeat top left":this._cs.backgroundColor="transparent",this._b.renderer&&this._b.renderer.view&&(this._b.renderer.view.style.opacity=0),delete this._b.setupClickTag,this.setupClickTag())}};"undefined"!=typeof TweenLite&&(Tween=TweenLite),"undefined"!=typeof PIXI&&PIXI.utils.skipHello(),window.addEventListener("load",AnimatedCore.init.bind(AnimatedCore));var AnimatedMath=new function(){this.getAngleBetweenObjects=function(e,t){var i=t.x-e.x,e=t.y-e.y;return Math.atan2(e,i)*PIXI.DEG_TO_RAD},this.getNextPointInDirection=function(e,t,i){e=e.clone();return e.x+=Math.cos(t*PIXI.DEG_TO_RAD)*i,e.y+=Math.sin(t*PIXI.DEG_TO_RAD)*i,e},this.getDistanceBetween=function(e,t){var i=t.x-e.x,e=t.y-e.y,e=Math.pow(i,2)+Math.pow(e,2);return Math.sqrt(e)},this.randomBetween=function(e,t){return e instanceof PIXI.Point&&(t=e.y,e=e.x),Math.floor(Math.random()*(t-e+1)+e)}},AnimatedUtils=new function(){this.extendObject=function(e){var t,i;for(e=e||{},t=1;t<arguments.length;t++){var n=arguments[t];if(n)for(i in n)n.hasOwnProperty(i)&&(e[i]=n[i])}return e},this.convertResources=function(e){var t,i={};for(t in e)if(e.hasOwnProperty(t)){var n,s,o=e[t];if(t.match(/\.json$/)||t.match(/\.json_image$/)){if(o.type===PIXI.LoaderResource.TYPE.JSON&&o.data&&"object"==typeof o.data.frames)for(n in o.data.frames)s=PIXI.AnimatedSprite.fromFrames([n]),n.match(/\//)&&(n=n.replace(/.+\//,"")),-1!=n.indexOf(".")&&(n=n.split(".")[0]),i[n]=s}else o.type===PIXI.LoaderResource.TYPE.IMAGE?(t.match(/\//)&&(t=t.replace(/.+\//,"")),-1!=t.indexOf(".")&&(t=t.split(".")[0]),i[t]=new PIXI.Sprite(o.texture)):console.log("UNRECOGNIZED ASSET: ",t,o)}return i}};